<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Agent Panel</title>
    <link href="{{STYLE_URI}}" rel="stylesheet" />
</head>
<body>
    <div class="agent-heading"></div>
    <div class="section">
        <div class="section-header">
            <div class="section-title">Team Management</div>
            <div class="info-icon-wrapper">
                <svg class="info-icon" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="8" cy="8" r="7" fill="none" stroke="currentColor" stroke-width="1.5"/>
                    <text x="8" y="11.5" text-anchor="middle" font-size="10" font-weight="bold" fill="currentColor">i</text>
                </svg>
                <div class="tooltip">
                    Create: Open the Git repo you want to associate with a new team, then click 'Create Team'.<br><br>Join: Make sure you have the correct project folder opened that matches the team you want to join, then click 'Join Team' and enter the code.<br><br>Switch: Open the correct project folder, click 'Switch Team', and select your team.
                </div>
            </div>
        </div>
        <div id="teamProduct">
            <div><strong>Current Team:</strong> <span id="teamName">—</span></div>
            <div><strong>Your Role:</strong> <span id="teamRole">—</span></div>

            <!-- Team Members Section -->
            <div id="teamMembersSection" style="display:none;">
                <div id="teamMembersHeader" class="team-members-header" onclick="toggleTeamMembers()">
                    <span class="members-toggle-icon">▶</span>
                    <strong>Team Members:</strong>
                    <span id="memberCount" class="member-count">0</span>
                </div>
                <div id="membersList" class="members-list" style="display:none;">
                    <!-- Members will be dynamically inserted here -->
                </div>
            </div>

            <div id="projectStatus" style="display:none; margin-top:4px;">
                <div id="projectStatusIndicator" style="font-size:12px;"></div>
            </div>
            <div id="joinCodeSection" style="display:none;">
                <strong>Join Code:</strong>
                <span id="teamJoinCode">—</span>
                <button class="button" id="copyJoinCodeBtn" title="Copy join code">Copy</button>
            </div>
            <div style="margin-top:8px; display:flex; gap:6px; flex-wrap:wrap;">
                <button class="button" id="switchTeamBtn">Switch Team</button>
                <button class="button" id="createTeamBtn">Create Team</button>
                <button class="button" id="joinTeamBtn">Join Team</button>
                <button class="button" id="refreshTeamsBtn" title="Refresh teams">Refresh</button>
                <button class="button danger" id="deleteTeamBtn" style="display:none;">Delete Team</button>
                <button class="button" id="leaveTeamBtn" style="display:none;">Leave Team</button>
            </div>
        </div>
    </div>

    <!-- Hidden metadata fields required by liveSharePanel.js for activity feed -->
    <div style="display:none;">
        <input id="fs-id" type="text" />
        <input id="fs-userId" type="text" />
        <input id="fs-teamId" type="text" />
        <input id="fs-updatedAt" type="text" />
    </div>

    <!-- AI Summary Section removed - edge function now handles automatic summarization -->
    <!-- Anchor element for Activity Feed (dynamically inserted by JS) -->
    <div id="fs-summary-feedback" class="feedback-text" style="display:none;"></div>

    <script nonce="{{NONCE}}" src="{{SCRIPT_URI}}"></script>
</body>
</html>
