<div class="tasks-container">
    <div class="tasks-header">
        <h2>Team Tasks</h2>
    </div>
    <div id="tasks-status" class="tasks-status">
        <span id="status-text">Loading...</span>
    </div>

    <!-- Admin Setup UI -->
    <div id="jira-setup" class="jira-setup" style="display: none;">
        <div class="setup-card">
            <h3>üîó Connect to Jira</h3>
            <p>Connect your team's Jira board to view and track tasks collaboratively.</p>

            <form id="jira-setup-form" class="jira-config-form">
                <div class="form-group">
                    <label for="jira-url">Jira Instance URL <span class="required">*</span></label>
                    <input
                        type="url"
                        id="jira-url"
                        name="jiraUrl"
                        required
                        placeholder="https://your-domain.atlassian.net"
                        class="input-field"
                    />
                    <small class="field-hint">Example: https://temple-cis-projects-in-cs.atlassian.net</small>
                </div>

                <div class="form-group">
                    <label for="jira-email">Jira Email <span class="required">*</span></label>
                    <input
                        type="email"
                        id="jira-email"
                        name="jiraEmail"
                        required
                        placeholder="your-email@example.com"
                        class="input-field"
                    />
                    <small class="field-hint">The email associated with your Jira account</small>
                </div>

                <div class="form-group">
                    <label for="jira-token">API Token <span class="required">*</span></label>
                    <input
                        type="password"
                        id="jira-token"
                        name="jiraToken"
                        required
                        placeholder="Enter your Jira API token"
                        class="input-field"
                    />
                    <small class="field-hint">
                        <a href="#" id="token-help-link" class="help-link">How do I get an API token?</a>
                        <br><br>
                        <strong>Note:</strong> After clicking "Connect to Jira", a dropdown menu will appear at the top of VS Code. Please select your project from the dropdown to complete the setup.
                    </small>
                </div>

                <div class="form-actions">
                    <button type="submit" class="button primary" id="connect-jira-btn">
                        <span class="button-icon">üîó</span>
                        Connect to Jira
                    </button>
                </div>

                <div id="jira-setup-status" class="setup-status" style="display: none;"></div>
            </form>

            <!-- Help tooltip for token generation -->
            <div id="token-help-tooltip" class="help-tooltip" style="display: none;">
                <div class="help-content">
                    <h4>How to Generate a Jira API Token</h4>
                    <ol>
                        <li>Go to Jira in your browser</li>
                        <li>Click your profile picture ‚Üí <strong>Manage account</strong></li>
                        <li>Navigate to the <strong>Security</strong> tab</li>
                        <li>Click <strong>Create and manage API tokens</strong></li>
                        <li>Click <strong>Create API token</strong></li>
                        <li>Give it a name and click <strong>Create</strong></li>
                        <li>Copy the token and paste it above</li>
                    </ol>
                    <button class="button small" id="close-help-tooltip">Got it!</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Member Waiting UI -->
    <div id="jira-waiting" class="jira-waiting" style="display: none;">
        <div class="waiting-card">
            <div class="waiting-icon">‚è≥</div>
            <h3>Jira Integration Not Configured</h3>
            <p>Please ask your team admin to set up the Jira integration.</p>
            <div class="waiting-tip">
                <strong>Tip:</strong> Once your admin connects Jira, all team members will be able to view and track tasks from the shared Jira board.
            </div>
        </div>
    </div>

    <!-- Tasks List UI -->
    <div id="tasks-content" class="tasks-content" style="display: none;">
        <div class="tasks-toolbar">
            <div class="tasks-actions">
                <button class="button small" id="create-task-btn" title="Create new task">
                    <span class="button-icon"></span>
                    Create Task
                </button>
                <button class="button small" id="ai-suggestions-btn" title="Get AI task recommendations">
                    <span class="button-icon"></span>
                    Get AI Suggestions
                </button>
                <button class="button small" id="refresh-tasks-btn" title="Refresh tasks">
                    <span class="button-icon"></span>
                    Refresh
                </button>
                <button class="button small disconnect-btn" id="disconnect-jira-btn" title="Disconnect from Jira" style="display: none;">
                    <span class="button-icon"></span>
                    Disconnect
                </button>
            </div>
            <div class="tasks-filters">
                <select id="sprint-filter" class="filter-select">
                    <option value="">All Issues</option>
                    <option value="backlog">üìã Backlog</option>
                </select>
                <select id="status-filter" class="filter-select">
                    <option value="">All Statuses</option>
                    <option value="To Do">To Do</option>
                    <option value="In Progress">In Progress</option>
                    <option value="Done">Done</option>
                </select>
                <select id="assignee-filter" class="filter-select">
                    <option value="">All Assignees</option>
                </select>
            </div>
        </div>

        <div id="tasks-list" class="tasks-list">
            <div class="loading-spinner">
                <div class="spinner"></div>
                <span>Loading tasks...</span>
            </div>
        </div>
    </div>

    <!-- Error State -->
    <div id="tasks-error" class="tasks-error" style="display: none;">
        <div class="error-card">
            <div class="error-icon">‚ö†Ô∏è</div>
            <h3>Unable to Load Tasks</h3>
            <p id="error-message">An error occurred while fetching tasks.</p>
            <button class="button" id="retry-tasks-btn">Try Again</button>
        </div>
    </div>

    <!-- Create Task Modal -->
    <div id="create-task-modal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Task</h3>
                <button class="modal-close" id="close-modal-btn" title="Close">&times;</button>
            </div>
            <form id="create-task-form">
                <div class="form-group">
                    <label for="task-summary">Summary <span class="required">*</span></label>
                    <input
                        type="text"
                        id="task-summary"
                        name="summary"
                        required
                        placeholder="Enter task summary"
                        maxlength="255"
                    />
                </div>

                <div class="form-group">
                    <label for="task-description">Description</label>
                    <textarea
                        id="task-description"
                        name="description"
                        rows="4"
                        placeholder="Enter task description (optional)"
                    ></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="task-type">Issue Type</label>
                        <select id="task-type" name="issuetype">
                            <option value="Task">Task</option>
                            <option value="Story">Story</option>
                            <option value="Bug">Bug</option>
                            <option value="Epic">Epic</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="task-priority">Priority</label>
                        <select id="task-priority" name="priority">
                            <option value="">None</option>
                            <option value="Highest">Highest</option>
                            <option value="High">High</option>
                            <option value="Medium" selected>Medium</option>
                            <option value="Low">Low</option>
                            <option value="Lowest">Lowest</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="task-story-points">Story Points</label>
                        <input
                            type="number"
                            id="task-story-points"
                            name="storypoints"
                            min="0"
                            max="100"
                            step="1"
                            placeholder="Optional"
                        />
                    </div>

                    <div class="form-group">
                        <label for="task-assignee">Assignee</label>
                        <select id="task-assignee" name="assignee">
                            <option value="">Unassigned</option>
                        </select>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="button secondary" id="cancel-task-btn">Cancel</button>
                    <button type="submit" class="button primary" id="submit-task-btn">
                        <span class="button-icon">‚úì</span>
                        Create Task
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
